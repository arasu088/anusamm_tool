<p id="notice"><%= notice %></p>

<h1 class="form_div">Abstract Quantity <%= link_to 'Add', new_abstract_quantity_path,:style=>"font-size: medium" %></h1>
<%= form_tag abstract_quantities_path, method: :get do %> 
  <div class="row form_div">
    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
      <%=select_tag 'project_id', options_for_select(Project.where("is_active=1").collect{ |u| [u.name, u.id] },params[:project_id]), {:prompt => "--select project--",:style=>"width:100%"}%>
    </div>
    <div class="col-xs-2 col-sm-2 col-md-2 col-lg-2">
      <%= submit_tag "search"%>
      <%= button_to "clear",abstract_quantities_path, :method => :get,:onclick=>"reload()" %>
    </div>             
  </div>
  <% end %>
<table id="abstract_quantity_tbl" class="form_div table table-striped table-condensed" style="width:90%">
  <thead>
    <tr>
      <th>Project</th>
      <th>Material</th>
      <th>Quantity</th>
      <th>Amount</th>
      <th>GST</th>
      <th>Total</th>
      <th colspan="2"></th>
    </tr>
  </thead>

  <tbody>
  <%if @abstract_quantities.present?%>
    <% @abstract_quantities.each do |abstract_quantity| %>
      <tr>
        <td><%= abstract_quantity.project.name %></td>
        <td><%= abstract_quantity.material.name %></td>
        <td><%= abstract_quantity.quantity.tap{|x| break x.to_i == x ? x.to_i : x} %></td>
        <td><%= abstract_quantity.amount.tap{|x| break x.to_i == x ? x.to_i : x} %></td>
        <td><%= abstract_quantity.gst.tap{|x| break x.to_i == x ? x.to_i : x} %></td>
        <td><%= abstract_quantity.total.tap{|x| break x.to_i == x ? x.to_i : x} %></td>
        <td><%= link_to 'Edit', edit_abstract_quantity_path(abstract_quantity) %></td>
        <td><%= link_to 'Destroy', abstract_quantity, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
    <tr>
      <th colspan="4"></th>
      <th>Total</th>
      <th><%=@total.tap{|x| break x.to_i == x ? x.to_i : x}%></th>
      <th colspan="2"></th>
    </tr>
  <% else %>
    <tr>
    <th colspan="8">No Records Found</th>
    </tr>
  <% end %>     
  </tbody>
</table>

<br>

<script>
function reload() {
  jQuery("#project_id").val('')
    }
</script>